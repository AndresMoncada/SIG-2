<!DOCTYPE html>
<html>
<meta charset="utf-8" />

<head>
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" />
	<script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"></script>
	<script type="text/javascript"
		src="countries.js"></script>
	<script type="text/javascript"
		src="cities.js"></script>
	<script type="text/javascript"
		src="hidro.js"></script>
	<script type="text/javascript"
		src="Dep.js"></script>


	<!-- Estilo para visuakizar en la pagina web -->


	<style>
		#map {
			width: 100%;
			height: 800px;
			box-shadow: 5px 5px 5px #888;
		}
	</style>

</head>

<body>
	<div id="map"></div>

	<script>
		var osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
			attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a>'

				+ 'contributors', maxZoom: 18

		});

		var ciudades = L.tileLayer.wms("http://localhost:8080/geoserver/wms", {
			layers: 'ciudades',
			format: 'image/png',
			transparent: true,
			tiled: true,
			attribution: "Natural Earth"

		});

		var hidrografia = L.tileLayer.wms("http://localhost:8080/geoserver/wms", {
			layers: 'hidrografia',
			format: 'image/png',
			transparent: true,
			tiled: true,
			attribution: "Natural Earth"

		});

		var pais = L.tileLayer.wms("http://localhost:8080/geoserver/wms", {
			layers: 'paises',
			format: 'image/png',
			transparent: true,
			tiled: true,
			attribution: "Natural Earth"

		});

		var countryStylev1 = {
			'color': "#0E00E2",
			'weight': 2,
			'opacity': 0.6
		};

		var citiesStyle = {
			'color': "#0CFF00",
			'weight': 2,
			'opacity': 0.6
		};

		var hidroStyle = {
			'color': "#0E00E2",
			'weight': 2,
			'opacity': 0.6
		};


/////////////////////////////////////////////////////////////////////////////
		function getColor(d) {
			return d > 100000000 ? '#800026' :
				d > 50000000 ? '#BD0026' :
					d > 20000000 ? '#E31A1C' :
						d > 10000000 ? '#FC4E2A' :
							d > 5000000 ? '#FD8D3C' :
								d > 2000000 ? '#FEB24C' :
									d > 1000000 ? '#FED976' :
										'#FFEDA0';
		};
		function countryStylev2(feature) {
			return {
				fillColor: getColor(feature.properties.pop_est),
				weight: 2,
				opacity: 1,
				color: 'white',
				dashArray: '3',
				fillOpacity: 0.7
			};
		}

		function getColorDep(d) {
			return d > 2500000 ? '#64731E' :
				d > 2000000 ? '#77942E' :
					d > 1500000 ? '#BAAD34' :
						d > 1000000 ? '#95B634' :
							d > 500000 ? '#C3D48B' :
								d > 250000 ? '#DBE4A9' :
									'#EAEFC8';
		};
		function DepStyle(feature) {
			return {
				fillColor: getColorDep(feature.properties.SHAPE_LEN),
				weight: 2,
				opacity: 1,
				color: 'white',
				dashArray: '3',
				fillOpacity: 0.7
			};
		}
///////////////////////////////////////////////////////////////////////////////
		function popup(feature, layer) {
			if (feature.properties && feature.properties.name) {
				layer.bindPopup(feature.properties.name);
			}
		}
		function popupDep(feature, layer) {
			if (feature.properties && feature.properties.NOM_DEPART) {
				layer.bindPopup(feature.properties.NOM_DEPART +'<br>Longitud:'+feature.properties.SHAPE_LEN);
			}
		}


	var icon_Capital = L.icon({
                iconUrl: 'https://cdn.icon-icons.com/icons2/1483/PNG/128/wifihome_102155.png',
                iconSize: [20, 20],
                popupAnchor: [-1, -10]
            });

            var icon_Ciudad = L.icon({
                iconUrl: 'https://cdn.icon-icons.com/icons2/2093/PNG/128/park_architecture_and_city_leisure_trees_landscape_nature_icon_128584.png',
                iconSize: [20, 20],
                popupAnchor: [-1, -10]
            });    

        function estiloMarker(feature, latlng) {

            return feature.properties.capital == 'S' ? L.marker(latlng, {
                icon: icon_Capital,
                draggable: false,
                title: "Clic para el Detalle"
            }).bindPopup('<b>Ciudad:</b> ' + feature.properties.ciudad) :
                L.marker(latlng, {
                    icon: icon_Ciudad,
                    draggable: false,
                    title: "Clic para el Detalle"
                }).bindPopup('<b>Ciudad:</b> ' + feature.properties.ciudad );
        };
/////////////////////////////////////////////////////////////////////////////////////////

		var map = L.map('map', {
			center: [1.614433, -75.609455],
			zoom: 5,
			layers: [osm],

			scrollWheelZoom: true
		});

		L.geoJson(countries,
			{
				style: countryStylev2,
				onEachFeature: popup

			}
		).addTo(map);

		L.geoJson(Dep,
			{
				style: DepStyle,
				onEachFeature: popupDep

			}
		).addTo(map);

		L.geoJson(hidro,
			{
				style: hidroStyle
			}

		).addTo(map);

		L.geoJson(cities,
			{
				 style: hidroStyle,
            			pointToLayer: estiloMarker

			}
		).addTo(map);

		L.control.scale({
			position: 'bottomright',
			imperial: false


		}).addTo(map);


	</script>
</body>

</html>